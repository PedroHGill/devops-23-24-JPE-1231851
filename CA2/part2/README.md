# CA2, Part 2 - Build Tools with Gradle



*  Create a new branch called tut-basic-gradle using the following command
```bash
git checkout -b tut-basic-gradle
```

* Extract the generated zip file inside the folder ”CA2/part2/” of your repository.
* We now have an ”empty” spring application that can be built using gradle.
* You can check the available gradle tasks by executing ```./gradlew tasks.```
* Delete the src folder. We want to use the code from the basic tutorial
* Copy the src folder (and all its subfolders) from the basic folder of the tutorial into this new folder.
* Copy also the files webpack.config.js and package.json
* Delete the folder src/main/resources/static/built/ since this folder should be generated from the javascrit by the webpack tool.
* You can now experiment with the application by using ```./gradlew bootRun.```
* Notice that the web page http://localhost:8080 is empty! This is because gradle is missing the plugin for dealing with the frontend code!

** IMPORTANT**

* Change imports in Employee.java *javax* to *jakarta*
* Add ```json "packageManager": "npm@9.6.7", ``` to package.json
* Add the following lines to the plugins block in build.gradle.
```groovy
id "org.siouan.frontend-jdk17" version "8.0.0"
```

* Add also the following code in build.gradle to configure the previous plug-in:
```groovy
frontend {
    nodeVersion = "16.20.2"
    assembleScript = "run build"
    cleanScript = "run clean"
    checkScript = "run check"
}
```
* Update the scripts section/object in package.json to configure the execution of
webpack:
```groovy
"scripts": {
    "watch": "webpack --watch -d --output ./target/classes/static/built/bundle.js",
    "webpack": "webpack",
    "build": "npm run webpack",
    "check": "echo Checking frontend",
    "clean": "echo Cleaning frontend",
    "lint": "echo Linting frontend",
    "test": "echo Testing frontend"
},
```
* You can now execute ```./gradlew build```. The tasks related to the frontend are also executed and the frontend code is generated.
* You may now execute the application by using ```./gradlew bootRun```

* You may now execute the application by using ```./gradlew bootRun```

* Add a task to gradle to copy the generated jar to a folder named ”dist” located a the project root folder level
```groovy
task copyJar(type: Copy) {
    dependsOn build
    from "$buildDir/libs"
    into "$projectDir/dist"
    include "*.jar"
}
```
* You may now execute the copyJar by using ```./gradlew copyJar```

* Add a task to gradle to delete all the files generated by webpack (usually located at src/resources/main/static/built/).
* This new task should be executed automatically by gradle before the task clean.

```groovy
task cleanFiles(type: Delete) {
    delete fileTree(dir: 'src/main/resources/static/built', include: '**/')
}

clean.dependsOn(cleanFiles)
```

* You may now execute the cleanFiles by using ```./gradlew cleanFiles```
* Finally, if everything is working as expected merge the branch to the main branch using the following command:
```groovy
git checkout main
git merge --no-ff tut-basic-gradle
git push
``` 
Add the tag ca2-part2
```groovy
git tag -a ca2-part2
git push
```
# Alternative technological solution for the build automation tool (Maven)

* Extract the generated zip file inside the folder ”CA2/part2_maven/” of your repository.
* We now have an ”empty” spring application that can be built using gradle.
* You can check the available maven plugins by running the command ```mvn -v ```.
* Delete the src folder. We want to use the code from the basic tutorial
* Copy the src folder (and all its subfolders) from the basic folder of the tutorial into this new folder.
* Copy also the files webpack.config.js and package.json
* Delete the folder src/main/resources/static/built/ since this folder should be generated from the javascrit by the webpack tool.
* You can now experiment with the application by using ```mvn spring-boot:run```
* Notice that the web page http://localhost:8080 is empty! This is because gradle is missing the plugin for dealing with the frontend code!

** IMPORTANT**

* Change imports in Employee.java *javax* to *jakarta*
* Add ```json "packageManager": "npm@9.6.7", ``` to package.json
* Add the following lines to the plugins section in pom.xml.
```groovy
    <plugin>
        <groupId>com.github.eirslett</groupId>
        <artifactId>frontend-maven-plugin</artifactId>
        <version>1.9.1</version>
        <configuration>
            <nodeVersion>v16.20.2</nodeVersion>
        <installDirectory>target</installDirectory>
        </configuration>
</plugin>
```
* Execute the command ```mvn clean install```. This will run tasks associated with the frontend and generate the frontend code.
* To run the application, use the command ```mvn spring-boot:run```
* The application can also be started with the command ```mvn spring-boot:run```
* Create a Maven task to copy the generated *jar* file to a *"dist"* folder at the root level of the project. This can be done by adding the following plugin to your *pom.xml* file:

```groovy
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <version>3.2.0</version>
    <executions>
        <execution>
            <id>copy-jar</id>
            <phase>package</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>${project.basedir}/dist</outputDirectory>
                <resources>
                    <resource>
                        <directory>${project.build.directory}</directory>
                        <includes>
                            <include>*.jar</include>
                        </includes>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin>
```

* Add a task to delete all the files generated by webpack (usually located at src/resources/main/static/built/).
* This new plugin should be executed automatically by maven before the plugin clean.

```groovy
<plugin>
        <artifactId>maven-clean-plugin</artifactId>
    <version>3.1.0</version>
        <configuration>
        <filesets>
        <fileset>
        <directory>${project.basedir}/src/main/resources/static/built</directory>
                <includes>
                    <include>**/*</include>
                </includes>
        </fileset>
        </filesets>
</configuration>
</plugin>
```

* You may now execute the clean by using  the command ```mvn clean```

# Conclusion
Gradle is a sophisticated and adaptable build tool that leverages a Groovy-based DSL for configuration files. It provides a high level of flexibility and is noted for its performance, thanks to its incremental build feature. Gradle also works flawlessly with many IDEs , making it a popular choice among developers.  
Maven, on the other hand, is a more traditional build tool with XML configuration files. It has a convention-over-configuration approach, making it easier to use for small tasks. Maven has a large ecosystem of plugins and is widely used in the Java community.  